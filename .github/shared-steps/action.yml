name: Shared Steps
description: run ui tests

runs:
    using: "composite"
    steps:
        - name: Install Node.js
          uses: actions/setup-node@v4
          with:
            node-version: "18"
  
        - name: Install dependencies
          run: npm ci
  
        - name: Install TypeScript and ts-node
          run: npm install -g typescript ts-node
  
        - name: Set current time as an environment variable
          run: |
            echo "CURRENT_DAY=$(date '+%Y-%m-%d')" >> $GITHUB_ENV
            echo "CURRENT_TIME=$(date '+%H-%M-%S')" >> $GITHUB_ENV
  
        - name: Run Search and Collect Ticket Statuses
          id: ticket-statuses
          run: |
            npx ts-node automation/scripts/GetListOfJirasToSkip.ts
            ticketStatusesFile="ticketStatuses.json"
            if [[ -f "$ticketStatusesFile" ]]; then
              ticketStatuses=$(cat "$ticketStatusesFile" | jq -r 'join("|")')
            else
              ticketStatuses=""
            fi
            echo "ticketStatuses=$ticketStatuses" >> $GITHUB_OUTPUT
  
        - name: Install playwright browsers
          run: npx playwright install --with-deps
  
        - name: Run Unit Tests
          run: npm run unit-tests
  